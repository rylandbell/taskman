include _includes/helper_functions.jade
extends layout

block content
  h1= title
  p Welcome to #{title}
  -if(message)
        .container
          .row
            .col-xs-4.pagination-centered
              .alert.alert-warning
                h4
                  .glyphicon.glyphicon-exclamation-sign 
                  |&nbsp;&nbsp;#{message}
  .container
    .row
      .col-xs-12.col-sm-6
        .btn.btn-primary#cal-init Send to Google Calendar
        br
        br
        .panel.panel-primary
            .panel-heading
              .panel-title 
                h4 Update Info
            .panel-body
              form(action="/"+"#{task._id}", method="post", role="form").panel-form.checkforname
                .row
                  .form-group
                    label Task Name
                    input.form-control(type='text' value='#{task.name}' name='name')
                  .container
                    .row
                      .form-group.col-xs-2
                        label Flagged?
                        input.form-control(type='checkbox' checked=task.flagged name='flagged')
                      .form-group.col-xs-4
                        label Completed?
                        input.form-control(type='checkbox' checked=task.completed name='completed')
                  .form-group
                    label Date Added
                    p.form-control-static
                      =task.dateAdded
                  .form-group
                    label Due Date
                    -if (task.dateDue)
                      input.form-control(type='date' value='#{task.dateDue}' name='dateDue')
                    -else
                      input.form-control(type='date' name='dateDue')
                  .form-group
                    label Details 
                    textarea.form-control(rows='10' name='details')
                      |#{task.details}
                  button.btn-primary.pull-right
                    .i.glyphicon.glyphicon-check
                    |  Submit Changes
      
      .col-xs-12.col-sm-6
        .panel.panel-primary#cal-panel
            .panel-heading
              .panel-title 
                h4 Add to Google Calendar
            .panel-body
                form(action="", method="post", role="form")#calendar-form
                  .form-group
                    label Event Name
                    input.form-control(type='text' value='#{task.name}' name='name')
                  .form-group
                    label Date
                    -if (task.dateDue)
                      input.form-control(type='date' value='#{task.dateDue}' name='date')
                    -else
                      input.form-control(type='date' name='date')
                  .form-group
                    label Duration
                    select.form-control(name='duration')
                      option(value=15) 0:15
                      option(selected='selected' value=30) 0:30
                      option(value=45) 0:45
                      option(value=60) 1:00
                      option(value=90) 1:30
                      option(value=120) 2:00
                      option(value=180) 3:00
                  .form-group
                    label Remove from TaskMan after sending to calendar?
                    input.form-control(type='checkbox' checked='checked')
                  button.btn.btn-primary#send-btn
                    | Submit
        .panel.panel-primary#auth-panel
            .panel-heading
              .panel-title 
                h4 Google Authentication
            .panel-body
              p We can only add events to your Google calendar with your permission. The button below will pop up an authentication window for your Google account.
              button.btn.btn-primary Go to Google Permissions

block scripts
  script(src='/javascripts/calendar.js')  
  script(src='https://apis.google.com/js/client.js')
